<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
	<PropertyGroup>
		<BuildDependsOn>
			BeforeBuild;
			Package;
			AfterBuild;
		</BuildDependsOn>
		<IntermediatePath>$(MSBuildThisFileDirectory)\..\Obj\$(MSBuildProjectName)</IntermediatePath>
		<_FullOutput>$([System.IO.Path]::GetFullPath('$(OutputDir)'))</_FullOutput>
	</PropertyGroup>
	<Target Name="Build" DependsOnTargets="$(BuildDependsOn)">
	</Target>
	<Target Name="BeforeBuild" />
	<Target Name="AfterBuild" />
	<Target Name="Package">
		<RemoveDir Directories="$(IntermediatePath)" Condition="Exists('$(IntermediatePath)')" />
		<MakeDir Directories="$(IntermediatePath)" />
		<Copy SourceFiles="@(Content)" DestinationFolder="$(IntermediatePath)" />
		<MakeDir Directories="$(_FullOutput)" Condition="!Exists('$(_FullOutput)')" />
		<Exec Command="&quot;$(MSBuildThisFileDirectory)\NuGet.exe&quot; pack &quot;@(Spec->'$(IntermediatePath)\%(Filename)%(Extension)')&quot; -b &quot;$(IntermediatePath)&quot; -o &quot;$(_FullOutput)&quot;" />
	</Target>
	
	<PropertyGroup>
		<CleanDependsOn>
			BeforeClean;
			CleanPackage;
			AfterClean;
		</CleanDependsOn>
	</PropertyGroup>
	<Target Name="Clean" DependsOnTargets="$(CleanDependsOn)">
	</Target>
	<Target Name="BeforeClean" />
	<Target Name="AfterClean" />
	<Target Name="CleanPackage">
		<ItemGroup>
			<_Del Include="$(_FullOutput)\$(MSBuildProjectName)*.nupkg" />
		</ItemGroup>
		<Delete Files="@(_Del)" />
		<RemoveDir Directories="$(IntermediatePath)" />
	</Target>
	
	<Target Name="Rebuild" DependsOnTargets="Clean;Build" />
</Project>