<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
	<PropertyGroup>
		<BuildDependsOn>
			BeforeBuild;
			Package;
			AfterBuild;
		</BuildDependsOn>
		<_FullOutput>$([System.IO.Path]::GetFullPath('$(OutputDir)'))</_FullOutput>
	</PropertyGroup>
	<Target Name="Build" DependsOnTargets="$(BuildDependsOn)">
	</Target>
	<Target Name="BeforeBuild" />
	<Target Name="AfterBuild" />
	<Target Name="Package">
		<MakeDir Directories="$(_FullOutput)" Condition="!Exists('$(_FullOutput)')" />
		<Exec Command="&quot;$(MSBuildThisFileDirectory)\NuGet.exe&quot; pack @(Spec->'%(FullPath)') -b @(Spec->'%(RootDir)%(Directory)') -o $(_FullOutput)" />
	</Target>
	
	<PropertyGroup>
		<CleanDependsOn>
			BeforeClean;
			CleanPackage;
			AfterClean;
		</CleanDependsOn>
	</PropertyGroup>
	<Target Name="Clean" DependsOnTargets="$(CleanDependsOn)">
	</Target>
	<Target Name="BeforeClean" />
	<Target Name="AfterClean" />
	<Target Name="CleanPackage">
		<ItemGroup>
			<_Del Include="$(_FullOutput)\$(MSBuildProjectName)*.nupkg" />
		</ItemGroup>
		<Delete Files="@(_Del)" />
	</Target>
	
	<Target Name="Rebuild" DependsOnTargets="Clean;Build" />
</Project>